# BESSPIN CI & Test Environment

### Galois will provide to TA-1 Teams:
- Team-specific forks of the GFE, Tool Suite, and Testgen GitLab repositories
  - These will all be identical at first, and based on the latest current release versions.
  - Teams are encouraged to customize these repos in whatever way makes their report generation workflow easiest for them.
	- The difference (git diff) between the initial and final states of these repos will be available as an evaluation artifact, along with test and PPA scores.
- A CI environment consisting of:
	- GitLab CI pipelines that will trigger runs when commits are made to GFE, Testgen, or Tool Suite forks.
	- “Runners” (FPGAs connected to host machines) to perform CI. TA-1 teams will not have direct access to Galois-hosted FPGA resources; they need to use Gitlab CI.
- Report output generated by CI:
	- GFE baseline test suite results: ISA, I/O peripherals, OS boots. These will be reported by GFE CI. They are expected to pass for a given processor bitstream before running security tests on that processor.
	- Power, Performance and Area (PPA) results: Tool Suite CI will run the Coremark and Mibench2 benchmark suites and report these results. FPGA utilization is not reported by CI, but can be measured for newly synthesized bitstreams using the get_ppa.py script provided in the GFE repo.
	- Security evaluation results. These are reported by Testgen tools as part of Tool Suite and Testgen CI.

### TA-1 Team Workflow
**Note:** CI logs (reports) can be found in each repository’s CI/CD -> Jobs section

**Summary Workflow:**

1.   To update your system under test (bitstreams, OS, toolchains, etc.), commit to GFE. The GFE CI will run independently, and validate that your changes are ready to run security tests against.
2.   To package your updated system, making it available for security tests, update git revisions in tool-suite/nix/gfe/gfe-srx.nix.
3.   To update the security tests themselves, commit config and implementation changes to Testgen. By default, Testgen CI will run against your current 'master' version of Tool Suite, which packages GFE.


### CI Process Diagram
![fig:ciDiagram](doc/doc-images/ci-diagram.png "CI Diagram")
